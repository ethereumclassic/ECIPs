---
lang: en
ecip: 1049
title: Change the ETC Proof of Work Algorithm to the SHA3 Standard
author: Alexander Tsankov (alexander.tsankov@colorado.edu)
status: LAST CALL
type: Standards Track
category: core
discussions-to: https://github.com/ethereumclassic/ECIPs/issues/13
created: 2019-01-08
license: Apache-2.0
---
# Change the ETC Proof of Work Algorithm to the SHA3 Standard

## Abstract
A proposal to replace the current Ethereum Classic proof of work algorithm with standard SHA3-256 (aka SHA3), as specified in the FIPS202 Standard.

The reference hash of string "ETC" in standard SHA3-256 is:

 `a089b3e99ad6e03e5974082f62939b190f80581321eecacb4a6d6487552cc956`
 
## Implementation Plan

* Activation Block: 14,000,000 (approx. 1 year from the date of acceptance on Sept 11, 2020). 
* Fallback Activation Block: 14,500,000
* If not activated by Block 14,500,000 this ECIP is voided and moved to `Rejected`. 

* We recommend `difficulty` be multiplied 100 times at the first SHA3 block after the final Ethash block. This is to compensate for the higher performance of SHA3 and to prevent a pileup of orphaned blocks at switchover. This is not required for launch.
* We recommend a FIPS-202 standard `sha3()` pre-compile of various instances be implemented (SHA3-256 being the most important, but also: SHA3-224/384/512}). This is not required for launch.

## Motivation

* A response to the recent double-spend attacks against Ethereum Classic. Most of this hashpower was rented or came from other chains, specifically Ethereum (ETH). A separate proof of work algorithm would encourage the development of a specialized Ethereum Classic mining community, and blunt the ability for attackers to purchase mercenary hash power on the open-market. 

* As a secondary benefit, deployed smart contracts and dapps running on chain are currently able to use `sha3()` in their code. This ECIP could open the possibility of smart contracts being able to evaluate chain state via a FlyClient, and simplify second layer (L2) development. 

* Ease of use in consumer processors. SHA3-256 is far more efficient per cycle of hashing than Ethash is. It requires very little memory and is a pre-compile on ARM standard processors, which is ubiquitous and easy to optimize for. 

## Rationale

### Reason 1: Similarity to Bitcoin
The Bitcoin network currently uses the CPU-intensive SHA256 Algorithm to evaluate blocks. When Ethereum was deployed it used a different algorithm, Dagger-Hashimoto, which eventually became Ethash on 1.0 launch. Dagger-Hashimoto was explicitly designed to be memory-intensive with the goal of ASIC resistance [1]. It has been provably unsuccessful at this goal, with Ethash ASICs currently easily available on the market.

SHA3 is the product of decades of research and the winner of a multi-year contest held by NIST that has rigorously verified its robustness and quality as a hashing algorithm. It is one of the only hashing algorithms besides SHA2 that is allowed for military and scientific-grade applications, and can provide sufficient hashing entropy for a proof of work system. This algorithm would position Ethereum Classic at an advantage in mission-critical blockchain applications that are required to use provably high-strength algorithms.[2]

A CPU-intensive algorithm like SHA3 would allow both the uniqueness of a fresh PoW algorithm that has not had ASICs developed against it, while at the same time allowing for organic optimization of a dedicated and financially committed miner base, much the way Bitcoin did with its own SHA2 algorithm.

If Ethereum Classic is to succeed as a project, we need to take what we have learned from Bitcoin and move towards CPU-hard PoW algorithms.

> At first, most users would run network nodes, but as the network grows beyond a certain point, it would be left more and more to specialists with server farms of specialized hardware. - Satoshi Nakamoto (2008-11-03) [3]

*Note: Please consider this is from 2008, and the Bitcoin community at that time did not differentiate between node operators and miners. I interpret "network nodes" in this quote to refer to miners, and "server farms of specialized hardware" to refer to mining farms.*


### Reason 2: Value to Smart Contract Developers
In Solidity, developers have access to the `sha3()` function, which allows a smart contract to efficiently calculate the hash of a given input. This has been used in a number of interesting projects launched on both Ethereum and Ethereum-Classic. Most Specifically a project called 0xBitcoin [4] - which the ERC-918 spec was based on.

0xBitcoin is a security-audited [5] dapp that allows users to submit a proof of work hash directly to a smart contract running on the Ethereum blockchain. If the sent hash matches the given requirements, a token reward is trustlessly dispensed to the sender, along with the contract reevaluating difficulty parameters. This project has run successfully for over 10 months, and has minted over 3 million tokens [6].

With the direction that Ethereum Classic is taking: a focus on Layer-2 solutions and cross-chain compatibility; being able to evaluate proof of work on chain, will be tremendously valuable to developers of both smart-contracts and node software writers. This could greatly simplify interoperability. 

## Implementation

Example of a Smart contract hashing being able to trustlessly Keccak-256 hash a hypothetical block header. Please Note that it is up to Solidity developers to update to the proper SHA3-256 in their code, or to develop a new op-code. 
![example](https://i.imgur.com/xh3WgCF.png)

Here is an analysis of Monero's nonce-distribution for "cryptonight", an algorithm similar to Ethash, which also attempts to be "ASIC-Resistant" it is very clear in the picture that before the hashing algorithm is changed there is a clear nonce-pattern. This is indicative of a major failure in a hashing algorithm, and should illustrate the dangers of disregarding proper cryptographic security. Finding a hashing pattern would be far harder using a proven system like SHA3:

![example](https://i.imgur.com/vVdmzm9.jpg)

Based on analysis of the EVM architecture [here](https://cdn.discordapp.com/attachments/223675625334898688/534597157693685760/eth.jpg) there are two main pieces that need to be changed:

1. The Proof of work function needs to be replaced with SHA3-256
1. The Function that checks the nonce-header  in the block needs to know to accept SHA3-256 hashes as valid for a block.

Note: The image is meant to say SHA3, not keccak256.
![example](https://i.imgur.com/2hobqOL.png)

* Fips 202 Standard for SHA3. Located [here](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf)
* Official Keccak Team Implementation Document for Hardware and Software. Located [here](https://keccak.team/obsolete/Keccak-implementation-3.1.pdf)

A testnet demonstating this ECIP was active for more than a year, with more information available at [Astor.host](https://astor.host)

* Node Implementation (based on Parity). Located [here](https://github.com/antsankov/parity-ethereum/tree/sha3)
* Keccak256 CPU Miner. Located [here](https://github.com/antsankov/ethereum-cpu-miner). Reached a speed of 200,000 hashes per second on a single Digital Ocean vCPU. 
* Block Explorer. Located [here](https://explore.astor.host/)
* Live Network Stats. Located [here](https://stats.astor.host/)

### References: 

1. https://github.com/ethereum/wiki/wiki/Dagger-Hashimoto#introduction
1. https://en.wikipedia.org/wiki/SHA-3
1. https://satoshi.nakamotoinstitute.org/emails/cryptography/2/
1. https://github.com/0xbitcoin/white-paper
1. https://github.com/EthereumCommonwealth/Auditing/issues/102
1. https://etherscan.io/address/0xb6ed7644c69416d67b522e20bc294a9a9b405b31

### Previous discussion from [Pull request](https://github.com/ethereumclassic/ECIPs/pull/8)
![example](https://i.imgur.com/09Rtv0V.png)
![example](https://i.imgur.com/1TJtgO7.png)
![example](https://i.imgur.com/TTLZunn.png)
![example](https://i.imgur.com/uOoBFF9.png)
![example](https://i.imgur.com/irYFhRy.png)
![example](https://i.imgur.com/AoChMCy.png)
